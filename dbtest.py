import sqlite3    
from os import listdir
  
print("Testing the table")

files = [f for f in listdir("./") if f.endswith('.db') ]
files.sort()
file_index=1
for file in files:

    with sqlite3.connect(file) as conn:        
        with sqlite3.connect("user_cve" + str(file_index) + ".db") as connpacktab:
            file_index+=1
            cmd = """SELECT nist.current_cve_id,nist.nist_json_cve_entry FROM nist INNER JOIN packtab ON nist.nist_json_cve_entry LIKE '%' || packtab.nist_json_cve_entry || '%' ;"""
            cur = conn.execute(cmd)
            res = cur.fetchall()
            my_final_set = set(res)    # unique
            my_final_list = sorted(my_final_set) # sorted again due to undefined sort in the set() 

            for x in range(len(my_final_list)):
                print(my_final_list[x])
